WITH ROAD AS(
SELECT A.NAMES['local']::VARCHAR AS NAME
     ,R.Class
     ,R.subclass
     ,SUM(R.length_m) AS SUM_OF_LENGTH
 FROM NETHERLANDS_OPEN_MAP_DATA.NETHERLANDS.V_ADMINISTRATIVE A
INNER
 JOIN(SELECT Class
            ,subclass
            ,length_m
            ,GEO_CORDINATES
        FROM NETHERLANDS_OPEN_MAP_DATA.NETHERLANDS.V_ROAD 
       WHERE SUBSTR(QUADKEY
             ,0
             ,8) IN ('12020210', '12020211')) R
   ON ST_COVERS(A.GEO_CORDINATES
            ,R.GEO_CORDINATES)
WHERE A.id IN('r324431@56'
            ,'r47811@69')
GROUP BY A.NAMES['local']
     ,R.Class
     ,R.subclass
ORDER BY R.class
     ,R.subclass)
SELECT CLASS,
SUBCLASS,
MAX(CASE WHEN NAME='Amsterdam' THEN SUM_OF_LENGTH END) AS AMSTERDAM,
MAX(CASE WHEN NAME='Rotterdam' THEN SUM_OF_LENGTH END) AS ROTTERDAM
FROM ROAD
GROUP BY CLASS,SUBCLASS
ORDER BY CLASS,SUBCLASS;