WITH DISTINCT_YEARS AS
(
SELECT
    DISTINCT
    CAST(SUBSTR(year,-4) AS UNSIGNED) YEAR,
    CAST(SUBSTR(year,-4) AS UNSIGNED) START_OF_DECADE,
    CAST(SUBSTR(year,-4) AS UNSIGNED)+9 END_OF_DECADE,
    SUBSTR(year,-4)   DECADE_OF
FROM
    Movie
),
NUMBER_OF_MOV_BY_YR AS
(
SELECT
COUNT(DISTINCT MID) NUM_OF_MOV,
CAST(SUBSTR(year,-4) AS UNSIGNED) YEAR
FROM
	Movie
GROUP BY
	CAST(SUBSTR(year,-4) AS UNSIGNED)
),
NUM_OF_MOV_IN_DECADE AS 
(
SELECT
	SUM(NUM_OF_MOV) TOTAL_MOVIES,
	DY.DECADE_OF
FROM
	NUMBER_OF_MOV_BY_YR NM,
	DISTINCT_YEARS DY
WHERE
	NM.YEAR BETWEEN DY.START_OF_DECADE AND DY.END_OF_DECADE
GROUP BY
	DY.DECADE_OF
)
SELECT
	DECADE_OF,
	TOTAL_MOVIES
FROM
	NUM_OF_MOV_IN_DECADE
WHERE
	TOTAL_MOVIES = (
		SELECT
			MAX(TOTAL_MOVIES)
		FROM
			NUM_OF_MOV_IN_DECADE
		)